<script>
  function buildOrbRing(containerId, items, radius=3.1, y=1.25) {
    const ring = document.getElementById(containerId);
    ring.innerHTML = '';
    const n = items.length;

    for (let i=0;i<n;i++){
      const t = (i/n)*Math.PI*2;
      const x = Math.cos(t)*radius;
      const z = -Math.sin(t)*radius; // inward-facing ring in A-Frame (-Z forward)

      // No manual yaw math. Let A-Frame aim things at the camera.
      const group = document.createElement('a-entity');
      group.setAttribute('position', `${x} ${y} ${z}`);

      // Orb
      const orb = document.createElement('a-entity');
      orb.setAttribute('class','clickable');
      orb.setAttribute('geometry','primitive:sphere; radius:0.25');
      orb.setAttribute('material','color:#ffd700; emissive:#ffd700; emissiveIntensity:0.5; opacity:0.95');
      orb.setAttribute('animation__glow','property=material.emissiveIntensity; dir=alternate; dur=2000; from:0.35; to:1; loop:true');
      orb.setAttribute('event-set__enter','_event:mouseenter; scale:1.3 1.3 1.3');
      orb.setAttribute('event-set__leave','_event:mouseleave; scale:1 1 1');
      orb.addEventListener('click',()=>window.open(items[i].url,'_blank','noopener'));

      // Label: billboard + mirror-fix (scaleX = -1). Double-sided, tiny z-offset.
      const label = document.createElement('a-entity');
      label.setAttribute('position','0 0.52 0.01');
      label.setAttribute('look-at','#camera');        // always face viewer
      label.setAttribute('scale','-1 1 1');           // fixes mirrored text in VR
      label.setAttribute('text',[
        `value:${items[i].title}`,
        'align:center',
        'anchor:center',
        'width:3.2',
        'wrapCount:28',
        'color:#ffd700',
        'side:double'
      ].join('; '));
      label.setAttribute('animation__color','property=components.text.material.color; type=color; from:#ffd700; to:#fff5a8; dir=alternate; dur=1800; loop:true');

      group.appendChild(orb);
      group.appendChild(label);
      ring.appendChild(group);
    }
  }
</script>